require 'rake/clean'

CLEAN.include(['*.o', '*.mod'])
CLOBBER.include('fruit_driver')

task :default => ["fruit_driver"]

SRC = FileList['*.f90']
OBJ = SRC.ext('o')

rule '.o' => '.f90' do |t|
  sh "ifort -c -o #{t.name} #{t.source} -L ../src/ -module ../src/"
end

file "fruit_driver" => OBJ do
  sh "ifort -o fruit_driver #{OBJ} -module ../src/ -lfruit -L../src"
end
      
# File dependencies go here ...
file 'fruit_driver.o' => ['fruit_data_test.o', 'fruit_test.o']
file 'fruit_data_test.o' => ['fruit_data_test.f90']
file 'fruit_test.o' => ['fruit_test.f90']

